-- CREAMOS LA BASE DE DATOS --
CREATE DATABASE Almacen;
USE Almacen;

-- CREAMOS LAS TABLAS --
CREATE TABLE Suministrador(
    SNUM VARCHAR(2) PRIMARY KEY,
    SNOMBRE VARCHAR(15),
    SITUACION INT(2),
    CIUDAD VARCHAR (15)
);

CREATE TABLE Producto(
    PNUM VARCHAR(2) PRIMARY KEY,
    PNOMBRE VARCHAR(15),
    COLOR VARCHAR(10),
    PESO INT (2),
    CIUDAD VARCHAR(15)
);

CREATE TABLE Ventas(
    SNUM VARCHAR(2) NOT NULL,
    PNUM VARCHAR(2) NOT NULL,
    CANTIDAD INT(3),
    PRIMARY KEY(SNUM, PNUM)
);

-- RECORDAR: SIEMPRE QUE SE NECESITE MODIFICAR ALGÚN ATRIBUTO O VALOR DEL ATRIBUTO SE DEBE HACER 
-- ANTES DE INTRODUCIR LOS DATOS

-- CLAVES FORÁNEAS --
ALTER TABLE Ventas ADD FOREIGN KEY (SNUM) REFERENCES Suministrador(SNUM);
ALTER TABLE Ventas ADD FOREIGN KEY (PNUM) REFERENCES Producto(PNUM);


-- ESCRIBIMOS LOS DATOS --
INSERT INTO Suministrador (SNUM, SNOMBRE, SITUACION, CIUDAD) VALUES ("S1", "Salazar", 20, "Londres");
INSERT INTO Suministrador (SNUM, SNOMBRE, SITUACION, CIUDAD) VALUES ("S2", "Jaime", 10, "Paris");
INSERT INTO Suministrador (SNUM, SNOMBRE, SITUACION, CIUDAD) VALUES ("S3", "Bernal", 30, "Paris");
INSERT INTO Suministrador (SNUM, SNOMBRE, SITUACION, CIUDAD) VALUES ("S4", "Corona", 20, "Londres");
INSERT INTO Suministrador (SNUM, SNOMBRE, SITUACION, CIUDAD) VALUES ("S5", "Aldana", 30, "Atenas");

INSERT INTO Producto (PNUM, PNOMBRE, COLOR, PESO, CIUDAD) VALUES ("P1", "Tuerca", "Rojo", 12, "Londres");
INSERT INTO Producto (PNUM, PNOMBRE, COLOR, PESO, CIUDAD) VALUES ("P2", "Perno", "Verde", 17, "Paris");
INSERT INTO Producto (PNUM, PNOMBRE, COLOR, PESO, CIUDAD) VALUES ("P3", "Birlo", "Azul", 17, "Roma");
INSERT INTO Producto (PNUM, PNOMBRE, COLOR, PESO, CIUDAD) VALUES ("P4", "Birlo", "Rojo", 14, "Londres");
INSERT INTO Producto (PNUM, PNOMBRE, COLOR, PESO, CIUDAD) VALUES ("P5", "Leva", "Azul", 12, "Paris");
INSERT INTO Producto (PNUM, PNOMBRE, COLOR, PESO, CIUDAD) VALUES ("P6", "Engrane", "Rojo", 19, "Londres");

INSERT INTO Ventas (SNUM, PNUM, CANTIDAD) VALUES ("S1", "P1", 300);
INSERT INTO Ventas (SNUM, PNUM, CANTIDAD) VALUES ("S1", "P2", 200);
INSERT INTO Ventas (SNUM, PNUM, CANTIDAD) VALUES ("S1", "P3", 400);
INSERT INTO Ventas (SNUM, PNUM, CANTIDAD) VALUES ("S1", "P4", 200);
INSERT INTO Ventas (SNUM, PNUM, CANTIDAD) VALUES ("S1", "P5", 100);
INSERT INTO Ventas (SNUM, PNUM, CANTIDAD) VALUES ("S1", "P6", 100);
INSERT INTO Ventas (SNUM, PNUM, CANTIDAD) VALUES ("S2", "P1", 300);
INSERT INTO Ventas (SNUM, PNUM, CANTIDAD) VALUES ("S2", "P2", 400);
INSERT INTO Ventas (SNUM, PNUM, CANTIDAD) VALUES ("S3", "P2", 200);
INSERT INTO Ventas (SNUM, PNUM, CANTIDAD) VALUES ("S4", "P2", 200);
INSERT INTO Ventas (SNUM, PNUM, CANTIDAD) VALUES ("S4", "P4", 300);
INSERT INTO Ventas (SNUM, PNUM, CANTIDAD) VALUES ("S4", "P5", 400);

-- CONSULTAS --
SELECT * FROM Suministrador WHERE CIUDAD LIKE "Paris";
SELECT * FROM Producto WHERE (COLOR LIKE 'Azul' OR PESO > 15) AND CIUDAD LIKE 'Londres';
SELECT COUNT(*) FROM Producto WHERE COLOR LIKE "Rojo";
SELECT DISTINCT CIUDAD FROM Suministrador;
SELECT SNOMBRE, CHARACTER_LENGTH(SNOMBRE) AS NUM_CARACTERES FROM Suministrador ORDER BY NUM_CARACTERES DESC;
SELECT SNOMBRE, REVERSE(SNOMBRE) AS NOMBRE_AL_REVES FROM Suministrador;
SELECT SNOMBRE FROM Suministrador WHERE SNOMBRE LIKE "%a";
SELECT SNOMBRE FROM Suministrador WHERE SNOMBRE LIKE "";

-- 10  
SELECT SUM(CANTIDAD) AS TOTAL_VENTAS, MAX(CANTIDAD) AS MAXIMO, MIN(CANTIDAD), AVG(CANTIDAD) AS MEDIA FROM Ventas; 
-- 11 SELECT * FROM Suministrador WHERE Suministrador.SNUM NOT IN (SELECT SNUM FROM Ventas);
-- 12 SELECT 
-- 13 
-- 14 SELECT 